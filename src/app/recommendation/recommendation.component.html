  <!-- NAVBAR -->
  <nav class="navbar">
    <div class="navbar-left">
      <button class="hamburger" (click)="toggleSidebar()" aria-label="Toggle sidebar">
        <span></span><span></span><span></span>
      </button>
      <span class="brand">SIGA <small class="brand-sub">Admin</small></span>
    </div>

    <form class="search-wrapper" (submit)="$event.preventDefault(); applyFilter()">
      <div class="search-field">
        <input
          type="search"
          class="search"
          placeholder="Recherche: nom, prÃ©nom, email..."
          [(ngModel)]="searchTerm"
          name="search"
          aria-label="Search candidates"
        />
        <button type="button" class="btn btn-search" (click)="applyFilter()" title="Rechercher">
          <i class="fas fa-search"></i>
        </button>
      </div>
    </form>

    <div class="navbar-right">
      <div class="user">
        <div class="user-info">
          <div class="user-emoji">ðŸ‘‹</div>
          <div class="user-text">
            <div class="user-hi">Bienvenue</div>
            <div class="user-name">{{ username }}</div>
          </div>
        </div>
        <button class="btn-logout" title="DÃ©connexion" (click)="onLogout()">
          <i class="fas fa-sign-out-alt"></i>
        </button>
      </div>
    </div>
  </nav>

  <!-- SIDEBAR -->
  <aside class="sidebar" [class.collapsed]="sidebarCollapsed">
    <div class="sidebar-top">
      <div class="brand">
        <i class="fas fa-rocket"></i>
        <span>SIGA</span>
      </div>
      <button class="collapse-btn" (click)="toggleSidebar()">
        <i class="fas" [ngClass]="sidebarCollapsed ? 'fa-angle-right' : 'fa-angle-left'"></i>
      </button>
    </div>

    <nav class="nav-links">
      <a routerLink="/getall" routerLinkActive="active">
        <i class="fas fa-tachometer-alt"></i><span class="link-text">Dashboard</span>
      </a>
      
      <a routerLink="/recommendation" routerLinkActive="active">
        <i class="fas fa-file-alt"></i><span class="link-text">Analyse CV</span>
      </a>
      <a routerLink="/getCandidats" routerLinkActive="active">
        <i class="fas fa-users"></i><span class="link-text">Candidats</span>
      </a>
      <a routerLink="/Calendrier" routerLinkActive="active">
        <i class="fas fa-calendar-alt"></i><span class="link-text">Calendrier</span>
      </a>
      <a routerLink="/OfferByAdmin" routerLinkActive="active">
      <i class="fas fa-briefcase"></i><span class="link-text">Gestion Offres</span>
    </a>
    </nav>

    <div class="sidebar-bottom">
      <div class="user-profile">
        <div class="avatar">ðŸ‘‹</div>
        <div class="user-info">
          <span class="name">Admin</span>
          <small class="role">Super Admin</small>
        </div>
      </div>
      <small class="version">v1.0 â€¢ SIGA</small>
    </div>
  </aside>

  <!-- MAIN CONTENT -->
  <main class="content" [class.expanded]="sidebarCollapsed">
    <header class="content-header">
      <div>
        <h1 class="content-title">Recommandations</h1>
        <p class="muted">DÃ©couvrez les candidats les mieux adaptÃ©s Ã  vos critÃ¨res.</p>
      </div>
    </header>

    <!-- CONTROLS SECTION (Updated) -->
    <div class="controls">
      <form (ngSubmit)="submitRecommendation()" #form="ngForm" class="input-card">
        <div class="input-group">
  <label for="offre" class="floating-label">SÃ©lectionner l'offre</label>
  <select
    id="offre"
    [(ngModel)]="selectedOffreId"
    name="selectedOffreId"
    required
    class="input-field"
  >
    <option [ngValue]="null" disabled selected hidden>SÃ©lectionner une offre</option>
    <option *ngFor="let o of offres" [ngValue]="o.idOffre">{{ o.titreOffre }}</option> 
  </select>
</div>

        <div class="input-group">
          <input
            id="experienceMin"
            type="number"
            [(ngModel)]="experienceMin"
            name="experienceMin"
            placeholder=" "
            required
            class="input-field"
            aria-label="ExpÃ©rience minimale en annÃ©es"
          />
          <label for="experienceMin" class="floating-label">ExpÃ©rience min. (ans)</label>
        </div>
        <button
          type="submit"
          class="btn btn-gradient"
          [disabled]="isLoading"
          aria-label="GÃ©nÃ©rer les recommandations"
        >
          <i *ngIf="isLoading" class="fas fa-spinner btn-spinner"></i>
          {{ isLoading ? 'Analyse en cours...' : 'GÃ©nÃ©rer Recommandations' }}
        </button>
      </form>
    </div>

    <!-- PROGRESS BAR -->
    <div *ngIf="isLoading" class="progress-container">
      <div class="progress-bar">
        <div class="progress-fill" [style.width.%]="progressValue"></div>
      </div>
      <div class="progress-text">{{ progressValue }}%</div>
    </div>

    <!-- MESSAGE -->
    <div
      class="message"
      *ngIf="message"
      [ngClass]="{'success': !message.includes('Erreur'), 'error': message.includes('Erreur')}"
    >
      <i class="fas" [ngClass]="message.includes('Erreur') ? 'fa-exclamation-circle' : 'fa-check-circle'"></i>
      {{ message }}
    </div>

    <!-- DISPLAY CANDIDATES -->
    <section class="cards-grid" *ngIf="candidates && candidates.length > 0">
      <article *ngFor="let c of filteredCandidates(); let i = index" class="candidate-card" [style.animation-delay]="i * 0.1 + 's'">
        <div class="card-head">
          <div class="avatar" [ngStyle]="{'background': avatarColor(c)}">{{ initials(c) }}</div>
          <div class="meta">
            <div class="name">{{ c.prenom }} {{ c.nom }}</div>
            <div class="sub muted">
              <i class="fas fa-envelope"></i> {{ c.email }}
              <span class="pipe">|</span>
              <i class="fas fa-briefcase"></i> {{ c.yearsOfExperience }} ans
            </div>
          </div>
          <div class="actions">
            <a
              *ngIf="c.cvPath"
              [href]="sanitizeUrl(c.cvPath)"
              target="_blank"
              title="Voir CV"
              class="action"
              aria-label="Voir le CV du candidat"
            >
              <i class="fas fa-file-alt"></i>
            </a>
            <button
              class="action"
              (click)="contactCandidate(c)"
              title="Contacter"
              aria-label="Contacter le candidat"
            >
              <i class="fas fa-paper-plane"></i>
            </button>
          </div>
        </div>
        <div class="card-body">
          <div class="score-row">
            <div class="score-left">
              <div class="score-label">Score de correspondance</div>
              <div class="score-value">{{ c.similarityScore | number:'1.0-0' }}%</div>
            </div>
            <div class="score-bar">
              <div class="bar">
                <div class="bar-fill" [style.width.%]="c.similarityScore"></div>
              </div>
            </div>
          </div>
        </div>
      </article>

      <div *ngIf="filteredCandidates().length === 0" class="empty">
        <div class="empty-ico">ðŸ˜”</div>
        <div>Aucun candidat ne correspond Ã  vos critÃ¨res.</div>
      </div>
    </section>
  </main>

  <!-- FOOTER -->
  <footer class="footer">
    <div class="footer-left">
      <div class="brand-info">
        <strong>SIGA</strong>
        <span>â€¢ 13 Rue Ibn Nafis, Les berges du Lac 3, Tunis</span>
      </div>
      <div class="footer-links">
        <a href="mailto:contact&#64;siga.com.tn"><i class="fas fa-envelope"></i> contact&#64;siga.com.tn</a>
        <span>â€¢</span>
        <a href="tel:+21671960281"><i class="fas fa-phone"></i> (+216) 71 960 281</a>
      </div>
    </div>
    <div class="footer-right">
      <span>v1.0</span>
      <a href="#">Privacy</a>
      <a href="#">Terms</a>
    </div>
  </footer>