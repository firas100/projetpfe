<!-- NAVBAR -->
<nav class="navbar">
  <div class="navbar-left">
    <button class="hamburger" (click)="toggleSidebar()" aria-label="Toggle sidebar">
      <span></span><span></span><span></span>
    </button>
    <span class="brand">SIGA <small class="brand-sub">Admin</small></span>
  </div>

  <form class="search-wrapper" (submit)="$event.preventDefault()">
    <div class="search-field">
      <input
        class="search"
        type="search"
        [(ngModel)]="searchTerm"
        name="search"
        placeholder="Recherche: nom, prÃ©nom, email..."
      />
      <button class="btn btn-search" type="button" (click)="applyFilter()">
        <i class="fas fa-search"></i>
      </button>
    </div>
  </form>

  <div class="navbar-right">
    <div class="notif">
      <button class="icon-btn" title="Notifications"><i class="fas fa-bell"></i></button>
    </div>

    <div class="user">
      <div class="user-info">
        <div class="user-emoji">ðŸ‘‹</div>
        <div class="user-text">
          <div class="user-hi">Bienvenue</div>
          <div class="user-name">{{ username }}</div>
        </div>
      </div>
      <button class="btn-logout" title="DÃ©connexion" (click)="onLogout()">
          <i class="fas fa-sign-out-alt"></i>
        </button>
    </div>
  </div>
</nav>

<!-- SIDEBAR -->
<aside class="sidebar" [class.collapsed]="sidebarCollapsed">
  <div class="sidebar-top">
    <div class="brand">
      <i class="fas fa-rocket"></i>
      <span>SIGA</span>
    </div>
    <button class="collapse-btn" (click)="toggleSidebar()">
      <i class="fas" [ngClass]="sidebarCollapsed ? 'fa-angle-right' : 'fa-angle-left'"></i>
    </button>
  </div>

   <nav class="nav-links">
    <a routerLink="/getall" routerLinkActive="active"><i class="fas fa-tachometer-alt"></i><span class="link-text">Dashboard</span></a>
    <a routerLink="/recommendation" routerLinkActive="active"><i class="fas fa-file-alt"></i><span class="link-text">Analyse CV</span></a>
    <a routerLink="/getCandidats" routerLinkActive="active"><i class="fas fa-users"></i><span class="link-text">Candidats</span></a>
    <a routerLink="/Calendrier" routerLinkActive="active"><i class="fas fa-calendar-alt"></i><span class="link-text">Calendrier</span></a>
    <a routerLink="/OfferByAdmin" routerLinkActive="active">
      <i class="fas fa-briefcase"></i><span class="link-text">Gestion Offres</span>
    </a>
  </nav>

  <div class="sidebar-bottom">
    <div class="user-profile">
      <div class="avatar">ðŸ‘‹</div>
      <div class="user-info">
        <span class="name">Admin</span>
        <small class="role">Super Admin</small>
      </div>
    </div>
    <small class="version">v1.0 â€¢ SIGA</small>
  </div>
</aside>

<!-- MAIN CONTENT -->
<div class="content">
  <div class="container mt-4">
    <h2>Calendrier des entretiens</h2>
    <button class="btn btn-primary mb-3 ms-2" (click)="openBatchModal()">Planifier par offre</button>

    <!-- Modal Batch par Offre -->
    <div class="modal" tabindex="-1" [ngClass]="{'show d-block': showBatchModal}">
      <div class="modal-dialog modal-lg">
        <div class="modal-content p-3">
          <div class="modal-header">
            <h5 class="modal-title">Planifier entretiens par offre</h5>
            <button type="button" class="btn-close" (click)="closeBatchModal()"></button>
          </div>
          <div class="modal-body">
            <form (ngSubmit)="planifierParOffre()" #batchForm="ngForm">
              <div class="mb-2">
                 <label>Offre</label>
  <select class="form-control"
          [(ngModel)]="selectedOffreId"
          name="offre"
          required
          (change)="loadHighScoringCandidates()">
            <option [ngValue]="null">-- SÃ©lectionnez --</option>
             <option *ngFor="let o of offres" [value]="o.idOffre">{{ o.titreOffre }}</option>
              </select>
              </div>
              <div class="mb-2">
  <label>Candidat</label>
  <select class="form-control" [(ngModel)]="selectedCandidatId" name="candidat">
    <option [ngValue]="null">-- SÃ©lectionnez --</option>
    <option *ngFor="let c of candidats" [value]="c.id_candidature">
      {{ c.nom }} {{ c.prenom }}
    </option>
  </select>
</div>
              <div class="mb-2">
                <label>Manager</label>
                <select class="form-control" [(ngModel)]="selectedManagerId" name="manager" required>
                  <option [ngValue]="null">-- SÃ©lectionnez --</option>
                  <option *ngFor="let m of managers" [ngValue]="m.id">{{ m.firstName }} {{ m.lastName }}</option>
                </select>
              </div>

              <div class="mb-2">
                <label>Date et heure</label>
                <input type="datetime-local" class="form-control" [(ngModel)]="selectedDate" name="date" required>
              </div>

              <div class="mb-2">
                <label>Score minimum</label>
                <input type="number" class="form-control" [(ngModel)]="minScore" name="minScore" min="0" max="100" (ngModelChange)="loadHighScoringCandidates()" required>
              </div>

              <div class="mb-2">
                <label>Commentaire</label>
                <textarea class="form-control" [(ngModel)]="commentaire" name="commentaire"></textarea>
              </div>

          
              <div class="d-flex justify-content-end mt-3">
                <button type="submit" class="btn btn-success me-2" [disabled]="highScoringCandidates.length === 0">Planifier</button>
                <button type="button" class="btn btn-secondary" (click)="closeBatchModal()">Annuler</button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>

    <!-- FullCalendar -->
    <full-calendar class="fc" [options]="calendarOptions"></full-calendar>
  </div>
</div>

<!-- FOOTER -->
<footer class="footer"> <div class="footer-left">
   <div class="brand-info"> <strong>SIGA</strong> 
    <span>â€¢ 13 Rue Ibn Nafis, Les berges du Lac 3, Tunis</span>
   </div> <div class="footer-links"> <a href="mailto:contact&#64;siga.com.tn" title="Contact via email">
     <i class="fas fa-envelope"></i> contact&#64;siga.com.tn </a> 
     <span>â€¢</span> <a href="tel:+21671960281" title="Call"><i class="fas fa-phone"></i> (+216) 71 960 281</a> </div> 
    </div> <div class="footer-right"> <span>v1.0</span> <a href="#" title="Privacy Policy">Privacy</a>
       <a href="#" title="Terms of Service">Terms</a> </div> 
      </footer>